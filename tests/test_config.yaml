# Test configuration for Flask vs ASP validation
# Expanded from 24 to 64 routes covering high-priority pages

# Base URLs
asp_base: "https://webb-site.com"
flask_base: "http://127.0.0.1:5000"

# Fixed test date for consistent comparisons
# Changed from 2024-10-01 (public holiday, no data) to 2024-10-02 (trading day with data)
test_date: "2024-10-02"

# Route test definitions
routes:
  # ==========================================
  # Index (1 route)
  # ==========================================
  - name: "dbpub index"
    path: "/dbpub/"
    params: []

  # ==========================================
  # Core Search & Browse (5 routes)
  # ==========================================
  - name: "searchorgs - company search"
    path: "/dbpub/searchorgs.asp"
    params:
      - n: "Tencent"
      - n: "Alibaba"

  - name: "searchpeople - person search"
    path: "/dbpub/searchpeople.asp"
    params:
      - n1: "Webb"
        n2: "David"
      - n1: "Li"
        n2: "Ka"

  # prices.asp and quotes.asp removed - not deployed on live ASP server
  # prices.asp exists in ASP source but not deployed (returns 404)
  # quotes.asp was Flask-only addition (deleted from codebase)

  - name: "events - corporate events"
    path: "/dbpub/events.asp"
    params:
      - {}
      - cat: "div"
        limit: "50"

  # ==========================================
  # Stock Listings (3 routes)
  # ==========================================
  - name: "listed - currently listed stocks"
    path: "/dbpub/listed.asp"
    params:
      - e: "m"
        t: "s"
        d: "2024-10-01"
      - e: "g"
        t: "s"
        d: "2024-10-01"
        sort: "codeup"
      - e: "a"
        t: "s"
        d: "2024-10-01"

  - name: "delisted - delisted stocks"
    path: "/dbpub/delisted.asp"
    params:
      - e: "m"
        t: "s"
      - e: "g"
        t: "s"
        sort: "datedn"

  - name: "code - stock code lookup"
    path: "/dbpub/code.asp"
    params:
      - code: "5"  # HSBC
      - code: "9"  # Delisted securities test case
      - code: "941"  # China Mobile
      - code: "1"  # CKH Holdings

  # ==========================================
  # Corporate Structure (4 routes)
  # ==========================================
  - name: "advisers - corporate advisors"
    path: "/dbpub/advisers.asp"
    params:
      - p: "1"  # Non-existent personID
        d: "2024-10-01"
      - p: "24855630"  # Jiayuan Services Holdings Limited
        sort: "advup"
        d: "2025-10-14"
      - p: "100"  # Example personID
        d: "2024-10-01"
        role: "auditor"

  - name: "officers - directors and officers"
    path: "/dbpub/officers.asp"
    params:
      - p: "1"  # HSBC personID
        d: "2024-10-01"
      - p: "100"  # Example personID
        d: "2024-10-01"
        pos: "ED"

  - name: "splits - stock splits and consolidations"
    path: "/dbpub/splits.asp"
    params:
      - {}
      - cat: "split"
        limit: "50"

  - name: "positions - director positions"
    path: "/dbpub/positions.asp"
    params:
      - p: "100"  # Example personID (was 'pid', corrected to 'p')
        d: "2024-10-01"
      - p: "200"  # Example personID
        d: "2024-10-01"

  # ==========================================
  # Company Data (1 route)
  # ==========================================
  - name: "orgdata - company data page"
    path: "/dbpub/orgdata.asp"
    params:
      - p: "16954"  # Capital Finance Holdings Limited (user example)
      - p: "1"  # HSBC personID
      - p: "12"  # China Mobile personID
      - code: "5"  # HSBC via stock code lookup
      - code: "5"  # HSBC via stock code with Submit=current
        Submit: "current"

  # ==========================================
  # Articles (3 routes)
  # ==========================================
  - name: "articles - individual article"
    path: "/dbpub/articles/shutdown2.asp"
    params: []

  - name: "articles - index"
    path: "/dbpub/articles/index.asp"
    params: []

  - name: "articles - root"
    path: "/dbpub/articles/"
    params: []

  # ==========================================
  # CCASS Analysis (7 routes)
  # ==========================================
  - name: "bigchanges - large shareholding changes"
    path: "/ccass/bigchanges.asp"
    params:
      - d: "2024-10-01"
      - d: "2024-10-01"
        minpct: "1"

  - name: "bigchangesissue - changes for specific stock"
    path: "/ccass/bigchangesissue.asp"
    params:
      - i: "62"  # HSBC issueID
      - i: "12"  # China Mobile issueID
        minpct: "0.5"

  - name: "bigchangespart - changes for specific participant"
    path: "/ccass/bigchangespart.asp"
    params:
      - part: "A00001"  # Example participant ID
      - part: "C00001"  # Example participant ID
        minpct: "1"

  - name: "cconc - CCASS concentration"
    path: "/ccass/cconc.asp"
    params:
      - d: "2024-10-01"
        e: "m"
      - d: "2024-10-01"
        e: "g"
        sort: "top5dn"

  - name: "cparticipants - CCASS participants"
    path: "/ccass/cparticipants.asp"
    params:
      - {}
      - search: "HSBC"

  - name: "ipstakes - investor participant stakes"
    path: "/ccass/ipstakes.asp"
    params:
      - d: "2024-10-01"
      - d: "2024-10-01"
        minpct: "5"

  - name: "choldings - holdings for stock"
    path: "/ccass/choldings.asp"
    params:
      - i: "62"  # HSBC issueID
        d: "2024-10-01"
      - i: "12"  # China Mobile issueID
        d: "2024-10-01"

  - name: "chldchg - CCASS holding changes"
    path: "/ccass/chldchg.asp"
    params:
      - i: "1088"  # HSBC Holdings (user example from implementation)
        d1: "2024-10-09"
        d: "2024-10-10"
        sort: "chngdn"
      - i: "1088"  # Auto-calculate d1 (defaults to 1 month before d)
        d: "2024-10-10"
      - i: "1088"  # Test different sort option
        d1: "2024-10-09"
        d: "2024-10-10"
        sort: "nameup"
      - i: "62"  # HSBC issueID (different from 1088)
        d1: "2024-10-01"
        d: "2024-10-02"
        sort: "chngdn"
      - i: "12"  # China Mobile
        d1: "2024-10-01"
        d: "2024-10-02"

  # ==========================================
  # Additional CCASS Routes (8 routes)
  # ==========================================
  - name: "cholder - CCASS holder history"
    path: "/ccass/cholder.asp"
    params:
      - part: "C00001"
      - part: "A00001"

  - name: "brokhist - broker history"
    path: "/ccass/brokhist.asp"
    params:
      - i: "62"
        d: "2024-10-01"
      - i: "12"
        d: "2024-10-01"

  - name: "cconchist - concentration history"
    path: "/ccass/cconchist.asp"
    params:
      - i: "62"
      - i: "941"

  - name: "ctothist - turnover history"
    path: "/ccass/ctothist.asp"
    params:
      - i: "62"

  - name: "custhist - custody history"
    path: "/ccass/custhist.asp"
    params:
      - i: "62"

  - name: "reghist - registered holder history"
    path: "/ccass/reghist.asp"
    params:
      - i: "62"

  - name: "ncipchg - non-CIP changes"
    path: "/ccass/ncipchg.asp"
    params:
      - d: "2024-10-01"

  - name: "portchg - portfolio changes"
    path: "/ccass/portchg.asp"
    params:
      - part: "C00001"
        d: "2024-10-01"

  # ==========================================
  # Directors & Board Composition (7 routes)
  # ==========================================
  - name: "boardcomp - board composition"
    path: "/dbpub/boardcomp.asp"
    params:
      - d: "2024-10-01"
      - e: "m"
        d: "2024-10-01"

  - name: "dirsHKPerPerson - directors per person"
    path: "/dbpub/dirsHKPerPerson.asp"
    params:
      - d: "2024-10-01"

  - name: "latestdirsHK - latest directors HK"
    path: "/dbpub/latestdirsHK.asp"
    params:
      - {}

  - name: "leagueDirsHK - league of directors"
    path: "/dbpub/leagueDirsHK.asp"
    params:
      - d: "2024-10-01"

  - name: "FDirsPerListcoHKdstn - female directors distribution"
    path: "/dbpub/FDirsPerListcoHKdstn.asp"
    params:
      - d: "2024-10-01"

  - name: "INEDHKDistnCos - INED distribution by company"
    path: "/dbpub/INEDHKDistnCos.asp"
    params:
      - d: "2024-10-01"

  - name: "INEDHKDistnPeople - INED distribution by people"
    path: "/dbpub/INEDHKDistnPeople.asp"
    params:
      - d: "2024-10-01"

  # ==========================================
  # Incorporation/Dissolution Statistics (11 routes)
  # ==========================================
  - name: "incHKannual - HK incorporations annual"
    path: "/dbpub/incHKannual.asp"
    params:
      - {}

  - name: "incHKmonth - HK incorporations by month"
    path: "/dbpub/incHKmonth.asp"
    params:
      - {}

  - name: "incHKsurvive - HK survival rates"
    path: "/dbpub/incHKsurvive.asp"
    params:
      - {}

  - name: "incHKcaltype - HK inc by calendar type"
    path: "/dbpub/incHKcaltype.asp"
    params:
      - {}

  - name: "disHKcaltype - HK dissolution by calendar type"
    path: "/dbpub/disHKcaltype.asp"
    params:
      - {}

  - name: "oldestHKcos - oldest HK companies"
    path: "/dbpub/oldestHKcos.asp"
    params:
      - {}

  - name: "regHKannual - HK registrations annual"
    path: "/dbpub/regHKannual.asp"
    params:
      - {}

  - name: "incFcal - foreign incorporations"
    path: "/dbpub/incFcal.asp"
    params:
      - {}

  - name: "disFcal - foreign dissolutions"
    path: "/dbpub/disFcal.asp"
    params:
      - {}

  - name: "domregHK - domicile registrations HK"
    path: "/dbpub/domregHK.asp"
    params:
      - {}

  - name: "incUKcaltype - UK incorporations by calendar type"
    path: "/dbpub/incUKcaltype.asp"
    params:
      - {}

  # ==========================================
  # Law & Finance Professionals (4 routes)
  # ==========================================
  - name: "hksols - HK solicitors"
    path: "/dbpub/hksols.asp"
    params:
      - {}
      - search: "Wong"

  - name: "hksolfirms - HK solicitor firms"
    path: "/dbpub/hksolfirms.asp"
    params:
      - {}

  - name: "hksolemps - HK solicitor employers"
    path: "/dbpub/hksolemps.asp"
    params:
      - {}

  - name: "auditorchanges - auditor changes"
    path: "/dbpub/auditorchanges.asp"
    params:
      - {}

  # ==========================================
  # Market Data & Analysis (10 routes)
  # ==========================================
  - name: "listingtrend - listing trends"
    path: "/dbpub/listingtrend.asp"
    params:
      - {}

  - name: "yearend - year-end statistics"
    path: "/dbpub/yearend.asp"
    params:
      - {}

  - name: "reportspeed - reporting speed"
    path: "/dbpub/reportspeed.asp"
    params:
      - {}

  - name: "hklistcowebs - HK listcos with websites"
    path: "/dbpub/hklistcowebs.asp"
    params:
      - d: "2024-10-01"

  - name: "hklistconowebs - HK listcos without websites"
    path: "/dbpub/hklistconowebs.asp"
    params:
      - d: "2024-10-01"

  - name: "lirteams - listing teams"
    path: "/dbpub/lirteams.asp"
    params:
      - {}

  - name: "str - stock total return chart"
    path: "/dbpub/str.asp"
    params:
      - {}  # Empty form (no stock selected)
      - i: "34920"  # Tianjin Construction Development Group (user example)
      - i: "62"  # HSBC - large cap with long history
        f: "1"  # Show directors' dealings
        b: "1"  # Show buybacks

  - name: "gemgrads - GEM graduates"
    path: "/dbpub/gemgrads.asp"
    params:
      - {}

  - name: "HKstocksByBoardLot - stocks by board lot"
    path: "/dbpub/HKstocksByBoardLot.asp"
    params:
      - d: "2024-10-01"

  - name: "rightsoo - rights out-of-the-money"
    path: "/dbpub/rightsoo.asp"
    params:
      - {}

  - name: "alltotrets - all stock total returns"
    path: "/dbpub/alltotrets.asp"
    params:
      - {}  # Default: 1994-01-03 to max date, no IPOs
      - d1: "1994-01-03"
        d2: "2023-08-22"
        sort: "tretdn"  # Match user's example URL
      - d1: "2020-01-01"
        d2: "2024-10-01"
        i: "1"  # Include IPOs after start date
      - d1: "2000-01-01"
        d2: "2024-10-01"
        sort: "cagrdn"  # Sort by CAGR descending
      - d1: "2024-01-01"
        d2: "2024-10-01"
        sort: "nameup"  # Short period, alphabetical

  - name: "buybacks - share buyback transactions"
    path: "/dbpub/buybacks.asp"
    params:
      - i: "31946"  # User example (test with stock code parameter)
        sc: "5"
        f: "d"
        sort: "datedn"
      - i: "62"  # HSBC - large cap likely has buybacks
        f: "d"
      - i: "62"  # Monthly aggregation
        f: "m"
      - i: "62"  # Yearly aggregation, unadjusted
        f: "y"
        u: "1"
      - i: "62"  # Show method, sort by value
        f: "d"
        e: "1"
        sort: "valudn"

# Normalization options
normalize:
  strip_whitespace: true
  remove_comments: true
  lowercase_tags: false  # Preserve tag case
  collapse_spaces: true
  # NOTE: CSS path differences are ACCEPTABLE and ignored by normalization
  # ASP uses relative paths (href="main.css")
  # Flask uses absolute paths (href="/static/css/main.css")
  # The normalize_html() function in test_routes.py handles this

# Timeout settings (seconds)
timeout:
  request: 60
  total: 300
  # Per-route timeout overrides for slow ASP queries
  route_timeouts:
    leagueDirsHK: 60
    incHKannual: 60
    incHKmonth: 60
    incHKsurvive: 60
    disHKcaltype: 60

# Reporting options
report:
  show_diff: true
  max_diff_lines: 20
  color_output: true
