{% extends "base.html" %}

{% block title %}Events: {{ n }}{% endblock %}

{% block content %}
{% if i == 0 %}
	<h2>Events of an issue</h2>
	<p><b>{{ n }}</b></p>
{% else %}
	<h2>{{ n }}</h2>
{% endif %}

<ul class="navlist">
	<li><a href="/TRnotes" target="_blank">Notes</a></li>
</ul>
<div class="clear"></div>

<form method="get" action="{{ url_for('events.events') }}">
	<input type="hidden" name="sort" value="{{ sort }}">
	<div class="inputs">
		Stock code: <input type="text" name="sc" size="5" value="">
		<input type="submit" value="Go">
	</div>
	<div class="clear"></div>
</form>

{% if i > 0 %}
	<h3>Events</h3>
	{% if not events %}
		<p><b>None found.</b></p>
	{% else %}
		<p><b>Please <a href="/contact">report</a> any errors or desired features.</b></p>
		<p class='widthAlert1'>Some data are hidden to fit your display.<span class='portrait'> Rotate?</span></p>
		<style>table.c4-6r td:nth-child(n+4):nth-child(-n+6) {text-align:right} th:nth-child(n+4):nth-child(-n+6) {text-align:right};</style>
		<table class="txtable c4-6r">
			<tr>
				<th class="colHide3"><a href="{{ url_for('events.events', i=i, sort='anndup' if sort=='annddn' else 'annddn') }}"><b>Announced</b></a></th>
				<th class="colHide3">Year-end</th>
				<th><a href="{{ url_for('events.events', i=i, sort='evntdn' if sort=='evntup' else 'evntup') }}"><b>Type</b></a></th>
				<th>Amount</th>
				<th class="colHide3">Value<br>in quote<br>curr.</th>
				<th>New:<br>Old</th>
				<th><a href="{{ url_for('events.events', i=i, sort='exdtup' if sort=='exdtdn' else 'exdtdn') }}"><b>ex-Date</b></a></th>
				<th class="colHide1">Distri-<br>bution</th>
				<th class="colHide1">Notes</th>
			</tr>
		{% for event in events %}
			{% set price = event.price %}
			{% set priceHKD = event.pricehkd %}
			{% if price %}{% set price = "{:.4f}".format(price) %}{% else %}{% set price = "-" %}{% endif %}
			{% if priceHKD %}{% set priceHKD = "{:.4f}".format(priceHKD) %}{% endif %}
			<tr>
				<td class="colHide3">{% if event.announced %}{{ event.announced }}{% endif %}</td>
				<td class="colHide3" style="white-space:nowrap">{% if event.yearend %}{{ event.yearend }}{% endif %}</td>
				<td {% if event.canceldate %}style='text-decoration:line-through;'{% endif %}><a href="/eventdets?e={{ event.eventid }}">{{ event.change }}</a></td>
				<td>{{ event.currency }} {{ price }}</td>
				<td class="colHide3">{% if priceHKD %}{{ priceHKD }}{% endif %}{% if event.fxdate %}*{% endif %}</td>
				<td>{% if event.new %}{{ event.new }}:{{ event.old }}{% endif %}</td>
				<td style="white-space:nowrap">{% if event.exdate %}{{ event.exdate }}{% endif %}</td>
				<td class="colHide1">{% if event.distdate %}{{ event.distdate }}{% endif %}</td>
				<td class="colHide1" style="max-width:120px">{{ event.notes }}</td>
			</tr>
		{% endfor %}
		</table>
		<p>*=estimated equivalent in the currency in which the share price is quoted, nearly always HKD.</p>
	{% endif %}
{% endif %}
{% endblock %}
