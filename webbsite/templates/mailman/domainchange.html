{%extends "base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<!--#include virtual="/dbeditor/cotop.inc"-->
<h2>{{ title }}</h2>
{# TODO: Port ASP logic: Call mailBar(2)... #}
<p>Use this form to update all e-mail addresses ending in the specified domain. 
If the new domain is left blank, then we just print a list of current addresses 
and make no change. Check your typing carefully - mistakes cannot be reversed!</p>
<form method="post" action="domainchange.asp">
	<table class="txtable">
		<tr>
			<td>Current domain</td>
			<td><input type="text" name="currentDomain" size="40" value="{{ currentDomain }}"></td>
		</tr>
		<tr>
			<td>New domain</td>
			<td><input type="text" name="newDomain" size="40"></td>
		</tr>
	</table>
	<p><input type="submit" value="Submit"></p>
</form>
{# TODO: Port ASP logic: If currentDomain="" Then
	hint=hint&"Enter current... #}
	<table>
	{# Call openMailrs(mailDB,rs)
	rs.Open "SELECT ID,mailAddr FROM LiveList WHERE Mid(mailAddr,InStr(mailAddr,'@')+1)='"&currentDomain&"'",MailDB
	Do Until rs.EOF
		ID=rs("ID")
		eMail=rs("mailAddr") #}
		<tr>
			<td>{{ eMail }}</td>
			<td>
			{# TODO: Port ASP logic: If newDomain>"" Then
				newMail=Left(eMail,Instr(... #}
			</td>
		</tr>
		{# TODO: Port ASP logic: rs.MoveNext
	Loop
	Call CloseConRs(mailDB,rs)... #}
	</table>
{% endif %}
<p><b>{{ hint }}</b></p>
<!--#include virtual="/dbeditor/cofooter.asp"-->
{% endblock %}
