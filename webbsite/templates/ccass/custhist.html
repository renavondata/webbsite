
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
{# functions1.asp functionality moved to Python helpers #}
<!--#include virtual="/dbpub/navbars.asp"-->
{# Variables moved to Flask route #}
<title>Custodian participants: {{ n }}</title>
<link rel="stylesheet" type="text/css" href="../templates/main.css"/>
</head>
<body>
{% extends "base_database.html" %}
{% block content %}
{% if not i %}
	<h2>Holdings of custodian participants</h2>
	<p><b>{{ stock_name }}</b></p>
{% else %}
{# TODO: Port ASP logic:
	Call orgBar(stock_name,p,0)
	Call ccassholdbar(i,atDa... #}
{% endif %}
<form method="get" action="custhist.asp">
	<input type="hidden" name="sort" value="{{ sort }}">
	<div class="inputs">
		Stock code: <input type="text" name="sc" size="5" value="">
		<input type="submit" value="Go">
	</div>
	<div class="clear"></div>
</form>
{% if i>0 %}
	<h3>Holdings of custodian participants</h3>
	{% if not history %}
		<p><b>No records for this issue.</b></p>
	{% else %}
		<table class="numtable yscroll">
		<tr>
			<th class="colHide1">Row</th>
			<th><a href="?i={{ i }}&amp;sort={% if sort == 'datedn' %}dateup{% else %}datedn{% endif %}">Holding<br>date</a></th>
			<th>Holding</th>
			<th class="colHide3">Change</th>
			<th>Stake<br>%</th>
			<th class="colHide2">Issued<br>shares</th>
			<th class="colHide1">As at date</th>
		</tr>
		{% for row in history %}
			<tr>
				<td class="colHide1">{{ loop.index }}</td>
				<td><a href="chldchg.asp?i={{ i }}&amp;d={{ row.atDate }}">{{ row.atDate }}</a></td>
				<td>{{ "{:,.0f}".format(row.holding) if row.holding is not none else '' }}</td>
				<td class="colHide3">
					{% if row.change is not none %}
						{{ "{:+,.0f}".format(row.change) }}
					{% endif %}
				</td>
				{% if row.shares is not none and row.shares > 0 %}
					<td>{{ "%.2f"|format(row.stake * 100) if row.stake is not none else '' }}</td>
					<td class="colHide2">{{ "{:,.0f}".format(row.shares) }}</td>
					<td class="colHide1">{{ row.atDate }}</td>
				{% else %}
					<td></td>
					<td class="colHide2"></td>
					<td class="colHide1"></td>
				{% endif %}
			</tr>
		{% endfor %}
		</table>
	{% endif %}
{% endif %}
	{# TODO: Port ASP logic: End If Call CloseConRs(con,rs)... #}
{% endblock %}
</body>
</html>