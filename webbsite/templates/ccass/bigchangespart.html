<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Big changes by {{ part_name }}</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/main.css') }}">
</head>
<body>
{% include 'includes/dbheader.html' %}

<h2>{{ part_name }}</h2>

{% if person_id > 0 %}
    {# Organization navigation bar #}
    <ul class="navlist">
        <li><a href="{{ url_for('dbpub_statistics.orgdata', p=person_id) }}">Key Data</a></li>
        <li><a href="{{ url_for('dbpub_corporate.officers', p=person_id) }}">Officers</a></li>
        <li><a href="{{ url_for('dbpub_statistics.overlap', p=person_id) }}">Overlaps</a></li>
        <li class="livebutton">CCASS holdings</li>
    </ul>
    <div class="clear"></div>

    {# CCASS participant navigation bar #}
    <ul class="navlist">
        <li><a href="{{ url_for('ccass.cholder', part=part_id, d='') }}">Holdings</a></li>
        <li><a href="{{ url_for('ccass.portchg', p=part_id, d='') }}">Changes</a></li>
        <li class="livebutton">Big changes</li>
        <li><a href="{{ url_for('ccass.bigchanges', d='') }}">Big changes all stocks</a></li>
        <li><a href="{{ url_for('ccass.cparticipants') }}">Participants</a></li>
        <li><a target="_blank" href="{{ url_for('ccass.ccass_notes') }}">About CCASS</a></li>
    </ul>
    <div class="clear"></div>
{% endif %}

<h3>Big changes in CCASS holdings</h3>
<p>This table shows daily movements by this participant larger than 0.25% of outstanding shares.
Click the "Change" heading to sort by absolute size of change. Click the stock name to see
the history of all holdings in this stock. Click the date of change to see the CCASS
movements for this stock on that date.</p>

{# Mobile hide columns indicator #}
<p class="widthAlert2">Some data are hidden to fit your display.<span class="portrait"> Rotate?</span></p>

<table class="numtable yscroll">
    <tr>
        <th class="colHide2">Row</th>
        <th class="colHide3">Stock<br>code</th>
        <th>
            <a href="{{ url_for('ccass.bigchangespart', part=part_id, sort='datedn' if sort!='datedn' else 'dateup') }}">
                <b>Date<br>Y-M-D</b></a>
        </th>
        <th class="left">
            <a href="{{ url_for('ccass.bigchangespart', part=part_id, sort='stckup' if sort!='stckup' else 'stckdn') }}">
                <b>Issue</b></a>
        </th>
        <th>
            <a href="{{ url_for('ccass.bigchangespart', part=part_id, sort='chgdn' if sort!='chgdn' else 'chgup') }}">
                <b>Change<br>%</b></a>
        </th>
        <th class="colHide3">Previous<br>change</th>
    </tr>
    {% set last_date = None %}
    {% for change in changes %}
    <tr>
        <td class="colHide2">{{ loop.index }}</td>
        <td class="colHide3">{{ change.stockCode if change.stockCode else '' }}</td>
        <td class="nowrap">
            {% if (sort in ['datedn', 'dateup']) and change.atDate == last_date %}
                {# Suppress duplicate dates when sorted by date #}
            {% else %}
                <a href="{{ url_for('ccass.chldchg', i=change.issueID, d=change.atDate.strftime('%Y-%m-%d')) }}">
                    {{ change.atDate.strftime('%Y-%m-%d') }}
                </a>
                {% set last_date = change.atDate %}
            {% endif %}
        </td>
        <td class="left">
            <a href="{{ url_for('dbpub_events.events', i=change.issueID) }}">
                {{ change.name1 }}:{{ change.typeShort }}
            </a>
        </td>
        <td>{{ "{:.2f}".format(change.stkchg * 100) }}</td>
        <td class="nowrap colHide3">
            {{ change.prevDate.strftime('%Y-%m-%d') if change.prevDate else '' }}
        </td>
    </tr>
    {% endfor %}
</table>

{% if changes|length == 0 %}
    <p>None found.</p>
{% endif %}

{% include 'includes/footer.html' %}
</body>
</html>
