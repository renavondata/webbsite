
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
{# functions1.asp functionality moved to Python helpers #}
{# Navigation bars #}
{# Variables moved to Flask route #}
<title>{{ title }}</title>
<link rel="stylesheet" type="text/css" href="../templates/main.css">
</head>
<body>
{% extends "base_database.html" %}
<h2>{{ title }}</h2>
{# TODO: Port ASP logic: Call ccassallbar(d2,4)... #}
<ul class="navlist">
	<li><a href="ipstakes.asp?d={{ d2 }}">Holdings</a></li>
	<li class="livebutton">Changes</li>
</ul>
<div class="clear"></div>	
<h3>Holding changes from {{ d1 }} to {{ d2 }}</h3>
<form method="get" action="ncipchg.asp">
	<input type="hidden" name="sort" value="{{ sort }}">
	<div class="inputs">
		From <input type="date" name="d1" id="d1" value="{{ d1 }}" onblur="this.form.submit()">
	</div>
	<div class="inputs">
		to <input type="date" name="d" id="d2" value="{{ d2 }}" onblur="this.form.submit()">
	</div>
	<div class="inputs">
		{{ checkbox("z",z,True) }} Show unchanged holdings
	</div>
	<div class="inputs">
		<input type="submit" value="Go">
		<input type="submit" value="Clear" onclick="document.getElementById('d1').value='';document.getElementById('d2').value='';document.getElementById('z').checked=false;">
	</div>
	<div class="clear"></div>
</form>
<p>"Value change" is the value of the change in shares at the closing price at the end of the period. &quot;*&quot;=stock is suspended
 or in parallel trading. Last close on this counter is used. Click the stake change to see the history in that stock.</p>
{{ mobile(2) }}
<table class="numtable yscroll">
	<tr>
		<th class="colHide1">Row</th>
		<th>{# TODO: Port ASP logic: SL "Last<br>code","codeup","codedn"... #}</th>
		<th style="text-align:left">{# TODO: Port ASP logic: SL "Name","nameup","namedn"... #}</th>
		<th class="colHide2">{# TODO: Port ASP logic: SL "Holding","holddn","holdup"... #}</th>
		<th class="colHide2">{# TODO: Port ASP logic: SL "Change", "chngdn","chngup"... #}</th>
		<th class="colHide3">{# TODO: Port ASP logic: SL "Holders<br>Change", "hchgdn","hchgup"... #}</th>
		<th class="colHide3"><%SL "Stake<br>%","stakdn","stakup"%></th>
		<th><%SL "Stake<br>&#x0394; %","stkcdn","stkcup"%></th>
		<th>{# TODO: Port ASP logic: SL "Value<br>change","valcdn","valcup"... #}</th>
		<th></th>
	</tr>
	{# cnt=0
	Do Until rs.EOF
		holding=Cdbl(rs("holding"))
		hldchg=Cdbl(rs("hldchg"))
		issueID=rs("issueID")
		stake=rs("stake")*100
		stkchg=rs("stkchg")*100
		valchg=rs("valchg")
		cntchg=rs("cntchg")
		cnt=cnt+1 #}
		<tr>
			<td class="colHide1">{{ cnt }}</td>
			<td>{{ row.stockCode }}</td>
			<td style="text-align:left"><a href="chldchg.asp?i={{ issueID }}&d1={{ d1 }}&d={{ d2 }}">{{ row.stockName }}</a></td>
			<td class="colHide2">{{ "{:,.\2f}".format(holding) }}</td>
			<td class="colHide2">{{ "{:,.\2f}".format(hldchg) }}</td>			
			<td class="colHide3">{{ "{:,.\2f}".format(cntchg) }}</td>
			<td class="colHide3">{{ "{:,.\2f}".format(stake) }}</td>
			<td><a href="nciphist.asp?i={{ issueID }}">{{ "{:,.\2f}".format(stkchg) }}</a></td>
			<td>{{ "{:,.\2f}".format(valchg) }}</td>
			<td>{# TODO: Port ASP logic: If rs("susp") Then Response.Write "*"... #}</td>
		</tr>
		{# TODO: Port ASP logic: rs.MoveNext
	Loop
	Call CloseConRs(con,rs)... #}
</table>
{% endblock %}
</body>
</html>