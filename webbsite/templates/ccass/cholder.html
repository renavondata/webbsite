<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CCASS Holdings: {{ participant_name }}</title>
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/main.css') }}">
</head>
<body>
{% include 'includes/dbheader.html' %}
<h2>CCASS Holdings by {{ participant_name }}</h2>

<form method="get" action="{{ url_for('ccass.cholder') }}">
	<input type="hidden" name="part" value="{{ part }}">
	<input type="hidden" name="sort" value="{{ sort }}">
	<div class="inputs">
		<input type="date" name="d" id="d" value="{{ d }}" onblur="this.form.submit()">
	</div>
	<div class="inputs">
		<input type="checkbox" name="z" id="z" value="1" {% if z %}checked{% endif %} onchange="this.form.submit()">
		<label for="z">Show zero holdings</label>
	</div>
	<div class="inputs">
		<input type="submit" value="Go">
	</div>
	<div class="clear"></div>
</form>

{% if not part %}
	<p><b>No participant selected. Please provide a partID.</b></p>
{% elif holdings|length == 0 %}
	<p><b>Database not yet loaded. Awaiting PostgreSQL import.</b></p>
	<p>This page will show all stocks held by participant {{ part }} ({{ participant_name }}) on {{ d }}.</p>
{% else %}
	<table class="numtable yscroll">
		<tr>
			<th class="colHide1">Row</th>
			<th><a href="{{ url_for('ccass.cholder', part=part, d=d, z=z, sort='scup' if sort!='scup' else 'scdn') }}">Stock<br>Code</a></th>
			<th class="left"><a href="{{ url_for('ccass.cholder', part=part, d=d, z=z, sort='nameup' if sort!='nameup' else 'namedn') }}">Issue</a></th>
			<th><a href="{{ url_for('ccass.cholder', part=part, d=d, z=z, sort='holddn' if sort!='holddn' else 'holdup') }}">Holding</a></th>
			<th class="colHide2">Stake %</th>
		</tr>
		{% for holding in holdings %}
		<tr>
			<td class="colHide1">{{ loop.index }}</td>
			<td>{{ holding.stockCode }}</td>
			<td class="left"><a href="{{ url_for('dbpub.orgdata', p=holding.personID) }}">{{ holding.name1 }}</a></td>
			<td>{{ "{:,.0f}".format(holding.holding) }}</td>
			<td class="colHide2">{{ "%.2f"|format(holding.stake * 100) if holding.stake else '' }}</td>
		</tr>
		{% endfor %}
	</table>
{% endif %}

{% include 'includes/footer.html' %}
</body>
</html>
