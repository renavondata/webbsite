
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" type="text/css" href="../templates/main.css">
<title>Opinion polls</title>
{# functions1.asp functionality moved to Python helpers #}
</head>
<body>
{% extends "base.html" %}
<h2>Opinion polls</h2>
{# Variables moved to Flask route #}
<p><b>Hong Kong time: {{ Left(MSdateTime(NowTime),16) }}</b></p>
<p>Welcome to <i>Webb-site.com</i> polls, where your vote can help change policy-making. 
Anyone can view the questions and the results, but to vote you will need to
<a href="../webbmail/login.asp">log in</a> with your Webb-site Account, or
<a href="../webbmail/join.asp">sign up</a> for one. You can change your vote at any time prior to the closing 
time, if any. Your e-mail address and individual votes will not be published.</p>

{# TODO: Port ASP logic: Call openMailrs(mailDB,rs)
rs.Open "SELECT * FROM ... #}
<h3>Live polls</h3>
<table class="txtable">
	<tr>
		<td><b>Poll name</b></td>
		<td><b>Start time</b></td>
		<td><b>Closing time</b></td>
		<td><b>Time remaining</b></td>
	</tr>
	{# Do Until rs.EOF
		EndTime=rs("EndTime") #}
		<tr>
			<td><a href='../vote/poll.asp?p={{ row.PID }}'>{{ row.PollName }}</a></td>
			<td>{{ Left(MSdateTime(row.StartTime),16) }}</td>
			{% if EndTime is none %}
				<td>Not set, please vote!</td>
				<td>Open</td>
			{% else %}
				<td>{{ MSdateTime(EndTime) }}</td>
				<td>{# TODO: Port ASP logic: If EndTime>NowTime Then
					Response.Write DiffTi... #}</td>
			{% endif %}
		</tr>
		{# TODO: Port ASP logic: rs.MoveNext
	Loop
	rs.Close... #}
</table>
<h3>Closed polls</h3>
<table class="txtable">
	<tr>
		<td><b>Poll name</b></td>
		<td><b>Start time</b></td>
		<td><b>Closed time</b></td>
		<td></td>
	</tr>
	
		<tr>
			<td><a href='../vote/poll.asp?p={{ PID }}'>{{ row.PollName }}</a></td>
			<td>{{ Left(MSdateTime(row.StartTime),16) }}</td>
			<td>{{ Left(MSdateTime(row.EndTime),16) }}</td>
			<td><a href="result.asp?p={{ PID }}">Result</a></td>
		</tr>
		{# TODO: Port ASP logic: rs.MoveNext
	Loop... #}
</table>

{% endblock %}
</body>
</html>