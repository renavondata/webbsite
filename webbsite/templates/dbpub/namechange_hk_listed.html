{% extends "base_database.html" %}
{% block title %}Name changes of HK-listed companies{% endblock %}
{% block content %}
<h2>Name changes of HK-listed companies</h2>

<table class="txtable yscroll" style="font-size:10pt">
    <tr>
        <th>
            {% if sort_param == 'newup' %}
                <a href="{{ url_for('dbpub_statistics.namechange_hk_listed', sort='newdn') }}"><b>Current Name</b></a>
            {% else %}
                <a href="{{ url_for('dbpub_statistics.namechange_hk_listed', sort='newup') }}">Current Name</a>
            {% endif %}
        </th>
        <th>
            {% if sort_param == 'oldup' %}
                <a href="{{ url_for('dbpub_statistics.namechange_hk_listed', sort='olddn') }}"><b>Old Name</b></a>
            {% else %}
                <a href="{{ url_for('dbpub_statistics.namechange_hk_listed', sort='oldup') }}">Old Name</a>
            {% endif %}
        </th>
        <th>
            {% if sort_param == 'datup' %}
                <a href="{{ url_for('dbpub_statistics.namechange_hk_listed', sort='datdn') }}"><b>Until</b></a>
            {% else %}
                <a href="{{ url_for('dbpub_statistics.namechange_hk_listed', sort='datup') }}">Until</a>
            {% endif %}
        </th>
    </tr>
    {% for row in changes_data %}
    {% set cur_name = row.name1 %}
    {% if row.cname %}
        {% set cur_name = cur_name ~ "<br>" ~ row.cname %}
    {% endif %}
    {% set old_name = "" %}
    {% if not row.oldname %}
        {% set old_name = row.oldcname or "" %}
    {% elif not row.oldcname %}
        {% set old_name = row.oldname %}
    {% else %}
        {% set old_name = row.oldname ~ "<br>" ~ row.oldcname %}
    {% endif %}
    <tr>
        <td><a href='{{ url_for('dbpub_statistics.enigma_orgdata', p=row.personid) }}'>{{ cur_name|safe }}</a></td>
        <td>{{ old_name|safe }}</td>
        <td>{{ row.datechanged.strftime('%Y-%m-%d') if row.datechanged else '' }}</td>
    </tr>
    {% endfor %}
</table>

{% endblock %}
