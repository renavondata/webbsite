{% extends "base_database.html" %}
{% block title %}{{ title }}{% endblock %}
{% block content %}
<h2>{{ title }}</h2>

<form method="get" action="/dbpub/veFRtypehist.asp">
	<div class="inputs">
		Vehicle class:
		<select name="vc" onchange="this.form.submit()">
			{% for cls in classes %}
			<option value="{{ cls.id }}" {% if cls.id == vc %}selected{% endif %}>{{ cls.des }}</option>
			{% endfor %}
		</select>
		Frequency:
		<select name="f" onchange="this.form.submit()">
			<option value="1" {% if f == 1 %}selected{% endif %}>Monthly</option>
			<option value="2" {% if f == 2 %}selected{% endif %}>Yearly</option>
		</select>
		<label><input type="checkbox" name="simple" value="1" {% if simple %}checked{% endif %} onchange="this.form.submit()"> Simple</label>
	</div>
</form>

{% if op and op_name %}
<p>Operator: <a href="/dbpub/orgdata.asp?p={{ op }}">{{ op_name }}</a></p>
{% endif %}

{% if data %}
<p>Total first registrations: {{ '{:,}'.format(total|int) if total else 0 }}</p>

<table class="numtable center yscroll">
	<tr>
		<th><a href="?vc={{ vc }}&f={{ f }}&{% if simple %}simple=1&{% endif %}sort={% if sort == 'datup' %}datdn{% else %}datup{% endif %}">{{ ftxt }}</a></th>
		<th><a href="?vc={{ vc }}&f={{ f }}&{% if simple %}simple=1&{% endif %}sort={% if sort == 'FRup' %}FRdn{% else %}FRup{% endif %}">First Reg</a></th>
		<th><a href="?vc={{ vc }}&f={{ f }}&{% if simple %}simple=1&{% endif %}sort={% if sort == 'licup' %}licdn{% else %}licup{% endif %}">Licensed</a></th>
		<th><a href="?vc={{ vc }}&f={{ f }}&{% if simple %}simple=1&{% endif %}sort={% if sort == 'regup' %}regdn{% else %}regup{% endif %}">Registered</a></th>
	</tr>
	{% for row in data %}
	<tr>
		<td>{{ row.d }}</td>
		<td>{{ '{:,}'.format(row.fr|int) if row.fr else 0 }}</td>
		<td>{{ '{:,}'.format(row.totlic|int) if row.totlic else 0 }}</td>
		<td>{{ '{:,}'.format(row.totreg|int) if row.totreg else 0 }}</td>
	</tr>
	{% endfor %}
</table>
{% else %}
<p>No data found for this vehicle class.</p>
{% endif %}

{% endblock %}
