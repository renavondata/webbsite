{% extends "base_database.html" %}
{% block title %}{{ title }}{% endblock %}

{% block content %}
<h2>{{ title }}</h2>

<ul class="navlist">
	<li><a href="/dbpub/TRnotes.asp" target="_blank">Notes</a></li>
	<li><a href="{{ url_for('dbpub_statistics.ctr') }}">Compare returns</a></li>
</ul>
<div class="clear"></div>

<p>This page shows the total returns in a fixed period of all ordinary shares
and REIT units which were primary-listed in HK at the start date and tradable on
at least 2 days in the period. &quot;*&quot; means the stock was delisted during the
period, for whatever reason. If a stock was suspended in a crisis and later
delisted, then its subsequent return may have been -100%! CAGR is the Compound
Annual Growth Rate, for stocks traded over a period of at least 180 days. Check
the box to include new listings after the start date. Please
<b><a href="/contact">report</a></b> any errors or desired features.</p>

<form method="get" action="{{ url_for('dbpub_market_data.alltotrets') }}">
	<input type="hidden" name="sort" value="{{ sort }}">
	<div class="inputs">
		Shares listed at: <input type="date" name="d1" id="d1" value="{{ d1 }}">
	</div>
	<div class="inputs">
		Period end: <input type="date" name="d2" id="d2" value="{{ d2 }}">
	</div>
	<div class="inputs">
		<input type="checkbox" name="i" id="i" value="1"{% if inc_ipo %} checked{% endif %}>
		<label for="i">Include new listings in period</label>
	</div>
	<div class="inputs">
		<input type="submit" value="Go">
		<input type="button" value="Clear" onclick="document.getElementById('d1').value='';document.getElementById('d2').value=''">
	</div>
	<div class="clear"></div>
</form>

{# Mobile warning - some columns hidden on narrow displays #}
<p class='widthAlert3'>Some data are hidden to fit your display.<span class='portrait'> Rotate?</span></p>

<table class="numtable yscroll">
	<tr>
		<th class="colHide2">Row</th>
		<th class="left colHide3">
			{% if sort == 'typeup' %}
				<a href="{{ url_for('dbpub_market_data.alltotrets', d1=d1, d2=d2, i=inc_ipo|int, sort='typedn') }}"><b>Type</b></a>
			{% else %}
				<a href="{{ url_for('dbpub_market_data.alltotrets', d1=d1, d2=d2, i=inc_ipo|int, sort='typeup') }}"><b>Type</b></a>
			{% endif %}
		</th>
		<th>
			{% if sort == 'codeup' %}
				<a href="{{ url_for('dbpub_market_data.alltotrets', d1=d1, d2=d2, i=inc_ipo|int, sort='codedn') }}"><b>Last<br/>code</b></a>
			{% else %}
				<a href="{{ url_for('dbpub_market_data.alltotrets', d1=d1, d2=d2, i=inc_ipo|int, sort='codeup') }}"><b>Last<br/>code</b></a>
			{% endif %}
		</th>
		<th class="left">
			{% if sort == 'nameup' %}
				<a href="{{ url_for('dbpub_market_data.alltotrets', d1=d1, d2=d2, i=inc_ipo|int, sort='namedn') }}"><b>Issuer</b></a>
			{% else %}
				<a href="{{ url_for('dbpub_market_data.alltotrets', d1=d1, d2=d2, i=inc_ipo|int, sort='nameup') }}"><b>Issuer</b></a>
			{% endif %}
		</th>
		<th class="colHide2">
			{% if sort == 'frstup' %}
				<a href="{{ url_for('dbpub_market_data.alltotrets', d1=d1, d2=d2, i=inc_ipo|int, sort='frstdn') }}"><b>First trade<br/>in period</b></a>
			{% else %}
				<a href="{{ url_for('dbpub_market_data.alltotrets', d1=d1, d2=d2, i=inc_ipo|int, sort='frstup') }}"><b>First trade<br/>in period</b></a>
			{% endif %}
		</th>
		<th class="colHide2">
			{% if sort == 'lastup' %}
				<a href="{{ url_for('dbpub_market_data.alltotrets', d1=d1, d2=d2, i=inc_ipo|int, sort='lastdn') }}"><b>Last trade<br/>in period</b></a>
			{% else %}
				<a href="{{ url_for('dbpub_market_data.alltotrets', d1=d1, d2=d2, i=inc_ipo|int, sort='lastup') }}"><b>Last trade<br/>in period</b></a>
			{% endif %}
		</th>
		<th></th>
		<th>
			{% if sort == 'tretdn' %}
				<a href="{{ url_for('dbpub_market_data.alltotrets', d1=d1, d2=d2, i=inc_ipo|int, sort='tretup') }}"><b>Total<br/>return</b></a>
			{% else %}
				<a href="{{ url_for('dbpub_market_data.alltotrets', d1=d1, d2=d2, i=inc_ipo|int, sort='tretdn') }}"><b>Total<br/>return</b></a>
			{% endif %}
		</th>
		<th class="colHide3">
			{% if sort == 'cagrdn' %}
				<a href="{{ url_for('dbpub_market_data.alltotrets', d1=d1, d2=d2, i=inc_ipo|int, sort='cagrup') }}"><b>CAGR</b></a>
			{% else %}
				<a href="{{ url_for('dbpub_market_data.alltotrets', d1=d1, d2=d2, i=inc_ipo|int, sort='cagrdn') }}"><b>CAGR</b></a>
			{% endif %}
		</th>
	</tr>
	{% for row in results %}
	<tr>
		<td class="colHide2">{{ row.row_num }}</td>
		<td class="left colHide3">{{ row.typeshort }}</td>
		<td>{{ row.lastcode }}</td>
		<td class="left">
			<a href="{{ url_for('dbpub_statistics.ctr', i1=row.issueid, d1=d1) }}">{{ row.name1 }}</a>
		</td>
		<td class="colHide2">{{ row.buydate }}</td>
		<td class="colHide2">{{ row.selldate }}</td>
		<td>{% if row.delisted %}*{% endif %}</td>
		<td>{{ row.totret_formatted | safe }}</td>
		<td class="colHide3">{{ row.cagr_formatted | safe }}</td>
	</tr>
	{% endfor %}
</table>

{% if count == 0 %}
<p><b>None found.</b></p>
{% endif %}

{% endblock %}
